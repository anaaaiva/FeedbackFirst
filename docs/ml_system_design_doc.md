# ML System Design Doc - [RU]
## Дизайн ML системы - FeedbackFirst MVP

### 1. Цели и предпосылки
#### 1.1. Зачем идем в разработку продукта?


- **Бизнес-цель проекта** \
    Создание системы для проведения пробных собеседований, которая помогает кандидатам подготовиться к реальным интервью в области Machine Learning. Система предоставляет персонализированную обратную связь и рекомендации, помогая пользователям оценить свои сильные и слабые стороны и улучшить навыки с помощью технологий больших языковых моделей (LLM) и Retrieval-Augmented Generation (RAG).

- **Почему станет лучше с использованием ML**
    - **Персонализированная обратная связь:** LLM/RAG адаптируют рекомендации по подготовке под конкретного пользователя на основе его ответов, обеспечивая высокую точность и контекстуальную релевантность.
    - **Автоматизация процесса:** Исключается необходимость участия HR-специалистов на этапе подготовки, что повышает доступность и частоту тренировок.
    - **Отслеживание прогресса:** Аналитика на основе ML позволяет оценивать динамику навыков пользователя, предлагая конкретные пути для их улучшения.
    - **Объективный анализ ответов:** система анализирует текстовые и голосовые ответы, выявляя ключевые аспекты — структура, логика, эмоциональная окраска.

- **Что будем считать успехом итерации с точки зрения бизнеса**
    - **Точность обратной связи:** Высокая оценка полезности рекомендаций пользователями или через технические метрики (прототип).
    - **Повышение успешности на реальных собеседованиях:** Увеличение числа пользователей, которые успешно проходят интервью после тренировки с системой (пилот).
    - **Снижение стресса перед собеседованиями:** Положительные изменения в уровне уверенности пользователей, подтвержденные опросами (пилот).
    - **Уровень вовлеченности:** Повторное использование системы и выполнение пользователями рекомендаций, что свидетельствует о доверии и полезности инструмента (пилот).

#### 1.2. Бизнес-требования и ограничения
- **Краткое описание бизнес-требований**
    - **Анализ речевой и текстовой информации** \
    Система должна анализировать текстовые и голосовые ответы кандидатов, оценивая их содержательность, структуру, логику, эмоциональную окраску и соответствие требованиям позиции.

    - **Персонализированная обратная связь** \
    На основе анализа система предоставляет детальную обратную связь о сильных и слабых сторонах пользователя.

    - **Интерактивные рекомендации** \
    Система должна выдавать индивидуальные рекомендации и тренировочные задания для повышения уровня подготовки.

    - **Поддержка различных типов собеседований** \
    Адаптация под специфические требования интервью для разных ролей и уровней опыта.

    - **Конфиденциальность данных** \
    Система должна гарантировать защиту персональной информации пользователей и их результатов.

- **Бизнес-ограничения**
    - **Ограниченные ресурсы** \
    В начальной стадии требуется минимизация затрат на разработку и внедрение, фокус на ключевой функциональности.

    - **Сроки разработки** \
    Разработка MVP должна быть завершена в рамках четко определенного времени.

- **Что мы ожидаем от конкретной итерации** \
    MVP должен включать следующие функции:
    - Базовый диалоговый интерфейс в виде веб-приложения или telegram бота.
    - Анализ текстовых ответов пользователя, сравнение их с эталонными ответами, предоставление обратной связи.
    - Базовые рекомендации по изучению различных тем для улучшения на основе анализа текстовых ответов.
    - Тестирование системы на ограниченной группе пользователей.
    - Сбор первых данных о пользовательском опыте и вовлеченности.

- **Описание бизнес-процесса пилота, насколько это возможно - как именно мы будем использовать модель в существующем бизнес-процессе?** \
    На данный момент система не будет встраиваться ни в какие бизнес процессы. При успешной разработке прототипа системы будет запущен пилот - открыт доступ для всех пользователей, когда каждый сможет оставить свой фидбек, на основе которого можно будет судить об успешности пилота и возможных сценариях улучшения.

- **Успешный пилот: критерии успеха и дальнейшие шаги**
    Критерии успеха пилота:

    - **Точность обратной связи** \
    Положительные отзывы от пользователей о точности и полезности предоставленных рекомендаций.

    - **Уровень вовлеченности** \
    Процент пользователей, которые прошли повторное собеседование и применили рекомендации.

    - **Успех на реальных собеседованиях** \
    Повышение процента пользователей, которые успешно прошли реальные интервью.

    - **Снижение стресса** \
    Измерение изменений в уровне уверенности через опросы.

    Дальнейшие шаги:
    - **Расширение функциональности** \
    Внедрение поддержки голосовых данных, улучшение качества персонализированных рекомендаций с использованием RAG.
    - **Масштабирование** \
    Добавление новых профессиональных сфер и типов собеседований.
    - **Улучшение аналитики** \
    Разработка более продвинутой системы отслеживания прогресса и метрик обучения.


#### 1.3. Что входит в скоуп проекта/итерации, что не входит

- **На закрытие каких БТ подписываемся в данной итерации** \
    - **Базовый диалог через LLM** \
    Ведение текстового диалога с пользователем: LLM задает вопросы, пользователь отвечает.
    - **Использование RAG для извлечения вопросов** \
    Хранение базы данных вопросов и эталонных ответов.
    Поиск наиболее релевантного вопроса для следующего шага на основе темы и прогресса пользователя.
    - **Анализ ответов** \
    Семантический анализ ответа пользователя: сравнение с эталонными ответами из базы.
    - **Базовая оценка качества ответа: корректность, полнота, структура.**
    - **Выдача простых подсказок по улучшению ответа.**
    Предложение дополнительных вопросов для закрепления материала.
    - **Реализация базового функционала веб-интерфейса**: отправка сообщений, прием ответов, передача данных на сервер для анализа.

- **Что не будет закрыто**
    - **Анализ голосовых данных** \
    Обработка и анализ аудиоответов, включая эмоциональную окраску или выявление волнения, не реализуются на этапе MVP.
    - **Окончательный вид веб-интерфейса**
    - **Поддержка различных профессиональных сфер** \
    Система будет заточена под общие ML-интервью, без адаптации под другие профессиональные роли.
    - **Продвинутая аналитика прогресса** \
    В текущей версии не будут реализованы детальные дашборды для отслеживания динамики навыков пользователя.

- **Описание результата с точки зрения качества кода и воспроизводимости решения**
    - **Качество кода** \
    Код будет документирован, обеспечивая базовый уровень читаемости и понятности.
    Применение стандартов кодирования (например, PEP 8 для Python).
    - **Воспроизводимость**
        - Возможность повторного запуска MVP-системы на основе инструкции и контейнеризации (например, Docker).
        - Подготовка скриптов для автоматического развертывания среды и загрузки необходимых данных.
    - **Простая интеграция** \
    API для взаимодействия фронтенда с бэкендом будет доступен с базовой документацией.

- **Описание планируемого технического долга (что оставляем для дальнейшей продуктивизации)**
    - Обработка голосовых данных: интеграция и настройка анализа аудиоответов для определения эмоционального состояния кандидата.
    - Оптимизация модели и производительности: текущая версия может работать медленнее на больших объемах данных, что потребует последующей оптимизации.
    - Расширенная аналитика и дашборды: будет добавлена в следующей итерации для предоставления более детальной обратной связи и визуализации прогресса.
    - Тестирование и качество кода: увеличение покрытия тестами и проведение нагрузочного тестирования.
    - Оптимизация и рефакторинг некоторых модулей для повышения производительности и упрощения поддержки.


#### 1.4. Предпосылки решения

- **Описание всех общих предпосылок решения, используемых в системе – с обоснованием от запроса бизнеса: какие блоки данных используем, горизонт прогноза, гранулярность модели, и др.** \

    - **Входные данные:**
        - Текстовые данные о карьерном опыте пользователя
        - Данные о вакансии, к собеседованию на которую человек хочет подготовиться (если есть), если нет, то текстовые данные о том, какие темы в хочет затронуть в интервью пользователь.
        - Промпты для LLM (для обеспечения качественной генерации и структурирования контента)
        - База с популярными вопросами с собеседований, а так же вопросов по определенным темам с ответами на них.

    - **Требования к LLM:**
        - Способность к структурированию и анализу текста
        - Понимание профессионального контекста и терминологии
        - Генерация релевантных формулировок и объяснений

    - **Технические ограничения:**
        - Время генерации вопроса и проверки ответа на него < 5-10 секунд
        - Обработка текста на русском языке
        - Ограничения на токены и запросы к LLM API или размер LLM для локального инференса

#### 2.1. Постановка задачи

Тип задачи: разработка системы для ведения диалога с пользователем на основе LLM в Telegram-боте с использованием Retrieval-Augmented Generation (RAG) для работы с базой вопросов и ответов.

Основные технические компоненты:
- Ведение диалога с пользователем (LLM)
    - Генерация вопросов из базы данных по темам собеседований.
    - Анализ текстовых ответов пользователя и предоставление обратной связи.
- Хранилище вопросов и ответов (RAG)
    - Использование векторного поиска (например, FAISS или Elasticsearch) для поиска наиболее подходящих вопросов.
    - Интеграция с LLM для формирования дополнительных рекомендаций и уточняющих вопросов на основе контекста.
- Анализ ответов пользователя (проверка качества ответов и предоставление обратной связи.)
    - Сравнение ответа пользователя с эталонным (семантическое сходство, логика, структура).
    - Оценка полноты ответа и выявление недочетов.
    - Выявление ключевых сильных и слабых сторон ответа.
- Рекомендации по улучшению (на основе анализа ответа пользователь получает персонализированные рекомендации.)
    - Подсказки по структуре ответа, улучшению логики или полноты.
    - Предложение дополнительных вопросов или тренировочных заданий.
- Интеграция с Telegram-ботом или другим веб-интерфейсом
    - Обеспечение интерактивного и удобного взаимодействия с пользователем.
    - Отправка вопросов, получение и анализ ответов, предоставление рекомендаций в режиме реального времени.

#### 2.2. Блок-схема решения

    #TODO

#### 2.3. Этапы решения задачи Data Scientist


**Этап 1 – Подготовка данных**
1. Загрузка базы вопросов и ответов.
2. Очистка, аннотирование и нормализация текстов.
3. Векторизация вопросов и ответов с использованием моделей генерации эмбеддингов (например, Sentence Transformers).
4. Сохранение эмбеддингов в векторной базе данных (например, FAISS или Chroma DB).
**На выходе:** набор векторных представлений вопросов и ответов, готовых для семантического поиска.

---

### Этап 2 – Обработка запроса пользователя
1. Получение ответа пользователя на заданный вопрос.
2. Предобработка текста ответа пользователя.
3. Векторизация ответа с использованием той же модели, что и для вопросов и ответов.
**На выходе:** эмбеддинг ответа пользователя.

---

### Этап 3 – Семантический поиск и анализ
1. Сравнение эмбеддинга ответа пользователя с эмбеддингами эталонных ответов.
2. Определение схожести (например, с помощью косинусного сходства). Нужно для того, чтобы ответ пользователя был наиболее близко к эталонному ответу определенного вопроса. Если он будет близок к ответу на другой вопрос, то это стоит отметить как отдаление от темы.
3. Выделение ключевых различий и пробелов в ответе пользователя с помощью LLM.
4. Формирование списка рекомендаций и дополнений для улучшения ответа с помощью LLM.
**На выходе:** анализ ответа пользователя с подсветкой ошибок, рекомендациями и примерами из эталонного ответа.

---

### Этап 4 – Обратная связь пользователю (на этапе MVP реализуется 1 пункт*)
1. Отображение результатов анализа в удобном формате:
   - Подсветка недостатков (где пользователь ошибся или упустил).
   - Дополнения к ответу (что можно улучшить или уточнить).
   - Примеры из эталонного ответа для контекста.
2. Возможность для пользователя уточнить или изменить ответ.
**На выходе:** интерактивная обратная связь для обучения. \

---

### Этап 5 – Адаптация модели (на этапе MVP не реализуется)
1. Сбор данных о том, как пользователи отвечают на вопросы:
   - Точность ответов.
   - Часто упускаемые темы.
2. Настройка модели под специфику реальных данных:
   - Добавление новых примеров.
   - Улучшение векторизации или алгоритмов поиска.
3. Тестирование системы на новых данных и обновление модели.
**На выходе:** улучшенная версия модели с учетом пользовательского опыта.

---

### Этап 6 – Мониторинг и улучшение (на этапе MVP не реализуется)
1. Отслеживание ключевых метрик:
   - Точность подсказок.
   - Доля исправленных ответов.
   - Удовлетворенность пользователей.
2. Обновление базы вопросов и ответов.
3. Внедрение улучшений на основе полученных данных.
**На выходе:** регулярное обновление системы для повышения качества обучения.